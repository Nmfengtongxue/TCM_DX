<!doctypehtml><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport"content="width=device-width,initial-scale=1"><title>中药饮片处方计价系统</title><link rel="stylesheet"href="css/styles.css"></head><body><script>document.addEventListener("DOMContentLoaded",function(){var t=document.getElementById("doctorName");t&&(t.textContent="中医师")})</script><div class="container"><header><h1>中药饮片处方计价系统</h1><div class="header-actions"><button id="helpBtn"class="btn btn-help"><svg xmlns="http://www.w3.org/2000/svg"width="16"height="16"fill="currentColor"viewBox="0 0 16 16"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/><path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/></svg> 使用说明</button></div><p>快速录入处方，自动计算总价，并保存顾客信息</p></header><div class="content"><div class="form-section"><h2 class="section-title">顾客信息</h2><div class="form-group"><label for="customerName">姓名</label> <input id="customerName"placeholder="请输入顾客姓名"></div><div class="form-group"><label for="customerAge">年龄</label> <input type="number"id="customerAge"placeholder="请输入年龄"></div><div class="form-group"><label for="customerPhone">联系方式</label> <input type="tel"id="customerPhone"placeholder="请输入电话号码"></div><div class="form-group"><label for="prescriptionInput">处方输入</label> <textarea id="prescriptionInput"class="prescription-input"placeholder="请输入药材名称（用空格或逗号分隔）&#10;例如：当归 黄芪 党参 或 当归,黄芪,党参&#10;支持传统剂量格式：桂枝(9g)、芍药(9g)、生姜(9g)、炙甘草(6g)"></textarea></div><div class="actions"><button id="searchBtn"class="btn"><svg xmlns="http://www.w3.org/2000/svg"width="16"height="16"fill="currentColor"viewBox="0 0 16 16"><path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/></svg> 检索药材</button> <button id="resetBtn"class="btn btn-reset"><svg xmlns="http://www.w3.org/2000/svg"width="16"height="16"fill="currentColor"viewBox="0 0 16 16"><path d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/><path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/></svg> 重置</button></div></div><div class="results-section"><div class="prescription-result"><div class="prescription-header"><h2 class="section-title">处方详情</h2><div class="prescription-info"><div class="dose-info"><span>剂数：</span> <input type="number"min="1"step="1"value="1"id="doseInput"class="dose-input"></div><div class="price-details"><div class="subtotal"><span>商品总价：</span> <span>¥<span id="subtotalPrice">0.00</span></span></div><div class="shipping-fee"><span>运费：</span> <input type="number"min="0"step="0.1"value="0"id="shippingFeeInput"class="shipping-input"> <span id="shippingFeeLabel">（满200免运费）</span></div><div class="total-price"><span>应付总额：</span> <span>¥<span id="totalPrice">0.00</span></span></div></div></div></div><div class="medicine-list"id="medicineList"><div class="not-found">请输入药材名称并点击检索</div></div><div class="actions"><div class="save-options"><button id="saveJsonBtn"class="btn save-btn"><svg xmlns="http://www.w3.org/2000/svg"width="16"height="16"fill="currentColor"viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/></svg> 保存为JSON</button> <button id="saveTxtBtn"class="btn save-btn"><svg xmlns="http://www.w3.org/2000/svg"width="16"height="16"fill="currentColor"viewBox="0 0 16 16"><path d="M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5L14 4.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5h-2z"/></svg> 保存为TXT</button> <button id="saveImageBtn"class="btn save-btn"><svg xmlns="http://www.w3.org/2000/svg"width="16"height="16"fill="currentColor"viewBox="0 0 16 16"><path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/><path d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1h12z"/></svg> 保存为图片</button></div><button id="settlementBtn"class="btn settlement-btn"style="background:linear-gradient(90deg,#27ae60 0,#2ecc71 100%)"><svg xmlns="http://www.w3.org/2000/svg"width="16"height="16"fill="currentColor"viewBox="0 0 16 16"><path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2zm13 2.383-4.758 2.855L15 11.114v-4.73zm-.034 6.878L9.271 8.82 8 9.583 6.728 8.82l-5.694 3.44A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.739zM1 11.114l4.758-2.876L1 5.383v5.73z"/></svg> 结算</button></div></div></div></div></div><div id="settlementModal"class="modal"><div class="modal-content"><div class="modal-header"><h2 class="modal-title">处方结算</h2><span class="close"id="settlementClose">&times;</span></div><div class="modal-body"><div class="standard-prescription"><h3>标准处方格式</h3><div class="prescription-info-section"><div class="patient-info"><p><strong>顾客姓名：</strong><span id="modalCustomerName">未填写</span></p><p><strong>年龄：</strong><span id="modalCustomerAge">未填写</span></p><p><strong>联系方式：</strong><span id="modalCustomerPhone">未填写</span></p></div><div class="prescription-date"><p><strong>处方日期：</strong><span id="modalPrescriptionDate"></span></p><p><strong>剂数：</strong><span id="modalDose">1</span>剂</p></div></div><div class="medicines-table"><table><thead><tr><th>药材名称</th><th>数量</th><th>单价</th><th>金额</th></tr></thead><tbody id="modalMedicinesList"></tbody><tfoot><tr><td colspan="3">商品总价</td><td id="modalSubtotal">¥0.00</td></tr><tr><td colspan="3">运费</td><td id="modalShippingFee">¥0.00</td></tr><tr class="total-row"><td colspan="3">总计</td><td id="modalTotal">¥0.00</td></tr></tfoot></table></div></div></div><div class="modal-footer"><button id="cancelSettlementBtn"class="btn btn-reset">取消</button> <button id="confirmSettlementBtn"class="btn">确认结算</button></div></div></div><div id="paymentModal"class="modal"><div class="modal-content payment-modal"><div class="modal-header"><h2 class="modal-title">支付二维码</h2><span class="close"id="paymentClose">&times;</span></div><div class="modal-body"><div class="payment-info"><h3>请扫描二维码支付</h3><div class="qr-code-container"><img id="paymentQrCode"src="image.png"alt="支付二维码"style="max-width:100%;height:auto;display:block;object-fit:contain"onload='document.getElementById("defaultQrCode").style.display="none"'onerror='document.getElementById("defaultQrCode").style.display="flex",this.style.display="none"'><div id="defaultQrCode"style="display:flex;width:250px;height:250px;background-color:#f8f9fa;align-items:center;justify-content:center;font-size:18px;color:#6c757d;border:1px solid #dee2e6">支付二维码</div></div><div class="payment-details"><p><strong>支付金额：</strong><span id="paymentAmount">¥0.00</span></p><p><strong>支付说明：</strong>扫描上方二维码完成支付，支付成功后处方将自动确认</p></div></div></div><div class="modal-footer"><button id="closePaymentBtn"class="btn">关闭</button></div></div></div><div id="helpModal"class="modal"><div class="modal-content help-modal"><div class="modal-header"><h2 class="modal-title">使用说明</h2><span class="close"id="helpClose">&times;</span></div><div class="modal-body"><div class="instructions-content"><ul><li>在处方输入框中，输入药材名称（用空格或逗号分隔）</li><li>支持多种剂量格式：</li><ul><li>现代格式：当归10g、黄芪20g</li><li>传统格式：桂枝(9g)、芍药(9g)</li><li>简单格式：当归 黄芪 党参（空格分隔）</li></ul><li>支持输入剂数（如"7剂"），系统会自动计算总剂量</li><li>点击"检索药材"按钮，系统会显示匹配的药材</li><li>可在数量框中调整所需剂量</li><li>剂数可手动调整，系统会自动重新计算总价</li><li>系统会自动计算总价并显示，满200元免运费</li><li>价格计算规则：</li><ul><li>单价显示：小数点后3位（与数据库保持一致）</li><li>结算价格：药材单价 × 数量 × 剂量</li><li>总价显示：小数点后2位（四舍五入）</li><li>实时更新：任何输入变化都会触发价格重新计算</li></ul><li>点击"结算"按钮，可查看标准处方格式和医师电子签名</li><li>确认结算后，系统会显示支付二维码，扫描完成支付</li></ul></div></div><div class="modal-footer"><button id="closeHelpBtn"class="btn">关闭</button></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.2/axios.min.js"></script><script type="module"src="js/script.js"></script></body></html>